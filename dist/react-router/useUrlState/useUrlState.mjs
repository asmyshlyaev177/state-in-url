import s from"react";import{useNavigate as b,useSearchParams as g}from"react-router-dom";import{parseSPObj as k}from"../../parseSPObj.mjs";import{useUrlStateBase as C}from"../../useUrlStateBase/useUrlStateBase.mjs";import{routerHistory as P,filterUnknownParamsClient as y,assignValue as H,filterUnknownParams as h}from"../../utils.mjs";function j(t,o){const r="defaultState"in t?t.defaultState:t,f="defaultState"in t?t.useHistory:o?.useHistory,d="defaultState"in t?{replace:t.replace,preventScrollReset:t.preventScrollReset}:{replace:o?.replace,preventScrollReset:o?.preventScrollReset},l=s.useMemo(()=>({...w,...d}),[]),u=b(),U=s.useMemo(()=>f?P:{replace:(e,a)=>u(e,{...l,...a}),push:(e,a)=>u(e,{...l,...a})},[u]),[n]=g(),{state:c,updateState:p,updateUrl:i,getState:v,reset:S}=C(r,U,({parse:e})=>e(y(r,n.entries()))),m=s.useCallback((e,a)=>i(e,{...l,...a}),[i]);s.useEffect(()=>{p(H(r,h(r,k(Object.fromEntries([...n.entries()]),r))))},[n]);const R=s.useCallback(e=>{S({...l,...e})},[S]);return{setState:p,updateState:p,setUrl:m,updateUrl:m,urlState:c,state:c,reset:R,getState:v}}const w={replace:!0,preventScrollReset:!0};export{j as useUrlState};
