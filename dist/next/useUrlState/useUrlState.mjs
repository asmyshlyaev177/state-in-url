import{useRouter as e,useSearchParams as t}from"next/navigation";import a from"react";import{parseSPObj as r}from"../parseSPObj.mjs";import{useUrlStateBase as s}from"../../useUrlStateBase/useUrlStateBase.mjs";import{isSSR as c,filterUnknownParamsClient as l}from"../../utils.mjs";function n(n,o){const{_defaultState:u,_searchParams:i,_replace:m}=function(e,t){const a="defaultState"in e,r=a?e.defaultState:e,s=a?e.searchParams:t,c=!!a&&(e.replace??!0);return{_defaultState:r,_searchParams:s,_replace:c}}(n,o),f=e(),{state:p,updateState:S,updateUrl:d,getState:j}=s(u,f,(({parse:e})=>c()?r(function(e,t){const a=Object.keys(e),r=Object.fromEntries(Object.entries(t||{}).map((([e,t])=>[e.replaceAll("+"," "),t])).filter((([e])=>a.includes(e))));return r}(u,i),u):e(l(u)))),b=a.useCallback(((e,t)=>{const a={scroll:!1,replace:m,...t};d(e,a)}),[d,m]),O=t();return a.useEffect((()=>{const e=Object.keys(u),t=Object.fromEntries([...O.entries()].filter((([t])=>e.includes(t))));S(r(t,u))}),[O]),{updateState:S,updateUrl:b,state:p,getState:j}}export{n as useUrlState};
