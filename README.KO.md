[English] | í•œêµ­ì–´ | [ç®€ä½“ä¸­æ–‡](./README.CN.md)


<div align="center">
  <img src="/assets/Logo_big.png?raw=true" alt="state-in-url logo"/>

  <div>IDE ìë™ ì™„ì„± ë° TS ê²€ì¦ê³¼ í•¨ê»˜ ê´€ë ¨ ì—†ëŠ” React ì»´í¬ë„ŒíŠ¸ ê°„ì— ìƒíƒœë¥¼ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë²ˆê±°ë¡œì›€ì´ë‚˜ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì—†ì´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
</div>


<div align="center">
<hr />


[![npm](https://img.shields.io/npm/v/state-in-url.svg)](https://www.npmjs.com/package/state-in-url)
![Tests](https://github.com/asmyshlyaev177/state-in-url/actions/workflows/tests.yml/badge.svg?branch=master)
[![Codacy Badge](https://app.codacy.com/project/badge/Grade/73be54068b7f41b0b74a252579ac09ec)](https://app.codacy.com/gh/asmyshlyaev177/state-in-url/dashboard?utm_source=gh&utm_medium=referral&utm_content=&utm_campaign=Badge_grade)
[![Commitizen friendly](https://img.shields.io/badge/commitizen-friendly-brightgreen.svg)](https://github.com/asmyshlyaev177/state-in-url/)
![npm bundle size (minified + gzip)](https://img.shields.io/bundlephobia/minzip/state-in-url.svg)
</div>

<div align="center">

<h4 align="center">ë²„ê·¸ë¥¼ ë°œê²¬í•˜ì…¨ë‹¤ë©´ ì£¼ì €í•˜ì§€ ë§ˆì‹œê³  ì´ìŠˆë¥¼ ì—´ì–´ì£¼ì„¸ìš”</h4>

![ë°ëª¨-gif](https://github.com/asmyshlyaev177/state-in-url/assets/19854148/c9802601-4d42-4362-b3e4-37ff87c3b97f)


<a href="https://state-in-url.dev" target="_blank">ë°ëª¨</a> |
<a href="https://state-in-url.netlify.app/" target="_blank">DEMO2</a> |


<hr />

í”„ë¡œì íŠ¸ë¥¼ ì§€ì›í•˜ë ¤ë©´ â­ï¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!

  <hr />

  </div>

  ## state-in-urlì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ”?

`state-in-url`ì€ URL ë™ê¸°í™”ì™€ í•¨ê»˜ ê°„ë‹¨í•œ ìƒíƒœ ê´€ë¦¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ê´€ë ¨ ì—†ëŠ” React ì»´í¬ë„ŒíŠ¸ ê°„ì— ë³µì¡í•œ ìƒíƒœë¥¼ ê³µìœ í•˜ê³ , ìƒíƒœë¥¼ URLê³¼ ë™ê¸°í™”í•˜ë©°, TS ì¹œí™”ì ì´ê³  NextJSì™€ í˜¸í™˜ë©ë‹ˆë‹¤.


# ì‚¬ìš© ì‚¬ë¡€

- ğŸ™ƒ URLì„ ë³€ê²½í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ê°„ì— ìƒíƒœë¥¼ ê³µìœ í•©ë‹ˆë‹¤. ì‹œê·¸ë„ ë° ê¸°íƒ€ ìƒíƒœ ê´€ë¦¬ ë„êµ¬ì˜ ëŒ€ì•ˆìœ¼ë¡œ ì¢‹ìŠµë‹ˆë‹¤.
- ğŸ”— ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœê°€ í¬í•¨ëœ ê³µìœ  ê°€ëŠ¥í•œ URL
- ğŸ”„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ìƒíƒœë¥¼ ì‰½ê²Œ ìœ ì§€
- ğŸ§  ê´€ë ¨ ì—†ëŠ” í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ ê°„ ë°ì´í„° ë™ê¸°í™”
- ğŸ§® ì €ì¥ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì–‘ì‹ì„ URLì— ì €ì¥

# íŠ¹ì§•

- ğŸ§© **ê°„ë‹¨í•¨**: í”„ë¡œë°”ì´ë”, ë¦¬ë“€ì„œ, ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ë˜ëŠ” ìƒˆë¡œìš´ ê°œë…ì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
- ğŸ“˜ **TypeScript ì§€ì› ë° íƒ€ì… ì•ˆì „ì„±**: ë°ì´í„° íƒ€ì…ê³¼ êµ¬ì¡°ë¥¼ ë³´ì¡´í•˜ê³ , IDE ì œì•ˆ, ê°•ë ¥í•œ íƒ€ì… ì§€ì • ë° JSDoc ì£¼ì„ìœ¼ë¡œ ê°œë°œì ê²½í—˜ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
- âš›ï¸ **í”„ë ˆì„ì›Œí¬ ìœ ì—°ì„±**: Next.jsì™€ React.js ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ë³„ë„ì˜ í›…ê³¼ ìˆœìˆ˜ JSë¥¼ ìœ„í•œ í•¨ìˆ˜ ì œê³µ
- âš™ **ì² ì €í•œ í…ŒìŠ¤íŠ¸**: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° Playwright í…ŒìŠ¤íŠ¸
- âš¡ **ë¹ ë¦„**: ìµœì†Œí•œì˜ ë¦¬ë Œë”ë§
- ğŸª¶ **ê²½ëŸ‰**: ì‘ì€ í¬ê¸°ë¥¼ ìœ„í•´ ì˜ì¡´ì„±ì´ ì—†ìŠµë‹ˆë‹¤.


## ëª©ì°¨

- [ì„¤ì¹˜](#ì„¤ì¹˜)
- [Next.jsìš© `useUrlState`](#nextjsìš©-useurlstate-í›…)
- [React.jsìš© `useSharedState`](#reactjsìš©-usesharedstate-í›…)
- [React.jsìš© `useUrlEncode`](#reactjsìš©-useurlencode-í›…)
- [ìˆœìˆ˜ JS ì‚¬ìš©ì„ ìœ„í•œ `encodeState` ë° `decodeState`](#ìˆœìˆ˜-js-ì‚¬ìš©ì„-ìœ„í•œ-encodestate-ë°-decodestate-í—¬í¼)
- [URLê³¼ ìƒíƒœ ìë™ ë™ê¸°í™”](#urlê³¼-ìƒíƒœ-ìë™-ë™ê¸°í™”)
- [ì €ìˆ˜ì¤€ `encode` ë° `decode` í•¨ìˆ˜](#ì €ìˆ˜ì¤€-encode-ë°-decode-í•¨ìˆ˜)
- [ëª¨ë²” ì‚¬ë¡€](#ëª¨ë²”-ì‚¬ë¡€)
- [ì£¼ì˜ì‚¬í•­](#ì£¼ì˜ì‚¬í•­)
- [ì—°ë½ ë° ì§€ì›](#ì—°ë½-ë°-ì§€ì›)
- [ë³€ê²½ ë¡œê·¸](#ë³€ê²½-ë¡œê·¸)
- [ë¼ì´ì„ ìŠ¤](#ë¼ì´ì„ ìŠ¤)
- [ì˜ê°](#ì˜ê°)

## ì„¤ì¹˜

### 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜

```sh
# npm
npm install --save state-in-url
# yarn
yarn add state-in-url
# pnpm
pnpm add state-in-url
```

### 2. tsconfig.json ìˆ˜ì •

`tsconfig.json`ì˜ `compilerOptions`ì—ì„œ `"moduleResolution": "Node16"` ë˜ëŠ” `"moduleResolution": "NodeNext"`ë¡œ ì„¤ì •í•˜ì„¸ìš”.

## Next.jsìš© useUrlState í›…

[ë¬¸ì„œ](packages/urlstate/next/useUrlState)

`useUrlState`ëŠ” Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ì‚¬ìš©ì ì •ì˜ React í›…ìœ¼ë¡œ, í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ ê°„ì˜ í†µì‹ ì„ ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤. ë³µì¡í•œ ìƒíƒœë¥¼ ê³µìœ í•˜ê³  URL ê²€ìƒ‰ ë§¤ê°œë³€ìˆ˜ì™€ ë™ê¸°í™”í•  ìˆ˜ ìˆê²Œ í•´ì£¼ì–´, í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  URLì„ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì‚¬ìš© ì˜ˆì‹œ

#### ê¸°ë³¸

1. ìƒíƒœ í˜•íƒœ ì •ì˜

   ```typescript
   // countState.ts
   // ìƒíƒœ í˜•íƒœëŠ” ìƒìˆ˜ì— ì €ì¥í•´ì•¼ í•˜ë©°, ê°ì²´ë¥¼ ì§ì ‘ ì „ë‹¬í•˜ì§€ ë§ˆì„¸ìš”
   export const countState: CountState = { count: 0 }

   type CountState = { count: number }
   ```

2. ì„í¬íŠ¸ ë° ì‚¬ìš©

```typescript
'use client'
import { useUrlState } from 'state-in-url/next';

import { countState } from './countState';

function MyComponent() {
  // ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ searchParams ì‚¬ìš© ì‹œ
  // ì˜ˆ: export default async function Home({ searchParams }: { searchParams: object }) {
  // const { state, updateState, updateUrl } = useUrlState(countState, searchParams);
  const { state, updateState, updateUrl } = useUrlState(countState);

  // ì‹¤ìˆ˜ë¡œ ìƒíƒœë¥¼ ì§ì ‘ ë³€ê²½í•˜ì§€ ëª»í•˜ê²Œ í•©ë‹ˆë‹¤. TS í•„ìš”
  // state.count = 2 // <- ì˜¤ë¥˜

  return (
    <div>
      <p>ì¹´ìš´íŠ¸: {state.count}</p>

      <button onClick={() => updateUrl({ count: state.count + 1 }), { replace: true }}>
        ì¦ê°€ (URL ì—…ë°ì´íŠ¸)
      </button>

        // React.useStateì™€ ë™ì¼í•œ API
      <button onClick={() => updateState(currState => ({...currState, count: currState.count + 1 }) )}>
        ì¦ê°€ (ë¡œì»¬ë§Œ)
      </button>
      <button onClick={() => updateUrl()}>
        ë³€ê²½ ì‚¬í•­ì„ URLì— ë™ê¸°í™”
        // ë˜ëŠ” ë™ê¸°í™”í•˜ì§€ ì•Šê³  ìƒíƒœë§Œ ê³µìœ 
      </button>

      <button onClick={() => updateUrl(state)}>
        ì´ˆê¸°í™”
      </button>
    </div>
  )
}
```

#### ë³µì¡í•œ ìƒíƒœ í˜•íƒœ ì‚¬ìš©

```typescript
interface UserSettings {
  theme: 'light' | 'dark';
  fontSize: number;
  notifications: boolean;
}

export const userSettings: UserSettings {
  theme: 'light',
  fontSize: 16,
  notifications: true,
}
```

```typescript
'use client'
import { useUrlState } from 'state-in-url/next';

import { userSettings } from './userSettings';

function SettingsComponent() {
  // `state`ëŠ” UserSettings íƒ€ì…ì—ì„œ ì¶”ë¡ ë©ë‹ˆë‹¤!
  const { state, updateUrl } = useUrlState(userSettings);

  const toggleTheme = () => {
    updateUrl(current => ({
      ...current,
      theme: current.theme === 'light' ? 'dark' : 'light',
    }));
  };

  // ìœ íœ´ ìƒíƒœì¼ ë•Œ ìƒíƒœë¥¼ URLì— ë™ê¸°í™”
  const timer = React.useRef(0 as unknown as NodeJS.Timeout);
  React.useEffect(() => {
    clearTimeout(timer.current);
    timer.current = setTimeout(() => {
      // ì°¸ì¡°ê°€ ì•„ë‹Œ ë‚´ìš©ìœ¼ë¡œ ìƒíƒœë¥¼ ë¹„êµí•˜ê³  ìƒˆ ê°’ì— ëŒ€í•´ì„œë§Œ ì—…ë°ì´íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤
      updateUrl(state);
    }, 500);

    return () => {
      clearTimeout(timer.current);
    };
  }, [state, updateUrl]);

  return (
    <div>
      <h2>ì‚¬ìš©ì ì„¤ì •</h2>
      <p>í…Œë§ˆ: {state.theme}</p>
      <p>ê¸€ê¼´ í¬ê¸°: {state.fontSize}px</p>
      <button onClick={toggleTheme}>í…Œë§ˆ ì „í™˜</button>
      {/* ë‹¤ë¥¸ ì„¤ì •ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•œ UI ìš”ì†Œ */}
    </div>
  );
}
...

// ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸
function Component() {
  const { state } = useUrlState(defaultSettings);

  return (
    <div>
      <p>ì•Œë¦¼ì€ {state.notifications ? 'ì¼œì§' : 'êº¼ì§'}</p>
    </div>
  )
}
```

#### ìƒíƒœ ìë™ ë™ê¸°í™”

```typescript
  const timer = React.useRef(0 as unknown as NodeJS.Timeout);
  React.useEffect(() => {
    clearTimeout(timer.current);
    timer.current = setTimeout(() => {
      // ì°¸ì¡°ê°€ ì•„ë‹Œ ë‚´ìš©ìœ¼ë¡œ ìƒíƒœë¥¼ ë¹„êµí•˜ê³  ìƒˆ ê°’ì— ëŒ€í•´ì„œë§Œ ì—…ë°ì´íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤
      updateUrl(state);
    }, 500);

    return () => {
      clearTimeout(timer.current);
    };
  }, [state, updateUrl]);
```

#### ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ì‚¬ìš©

```typescript
export default async function Home({ searchParams }: { searchParams: object }) {
  return (
    <Form sp={searchParams} />
  )
}

// Form.tsx
'use client'
import React from 'react';
import { useUrlState } from 'state-in-url/next';
import { form } from './form';

const Form = ({ sp }: { sp: object }) => {
  const { state, updateState, updateUrl } = useUrlState(form, sp);
}
```

#### `layout` ì»´í¬ë„ŒíŠ¸ì—ì„œ í›… ì‚¬ìš©

ì´ëŠ” ê¹Œë‹¤ë¡œìš´ ë¶€ë¶„ì…ë‹ˆë‹¤. Next.jsì˜ app ë¼ìš°í„°ëŠ” ì„œë²„ ì‚¬ì´ë“œì—ì„œ searchParamsì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ í•©ë‹ˆë‹¤. ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” í•´ê²°ì±…ì´ ìˆì§€ë§Œ, ì´ëŠ” ì•„ë¦„ë‹µì§€ ì•Šê³  Next.js ì—…ë°ì´íŠ¸ í›„ ì‘ë™ì´ ì¤‘ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
// ì ì ˆí•œ `layout.tsc`ì— ì¶”ê°€
export const runtime = 'edge';

// middleware.ts
import type { NextRequest } from 'next/server';
import { NextResponse } from 'next/server';

export function middleware(request: NextRequest) {
  const url = request.url?.includes('_next') ? null : request.url;
  const sp = url?.split?.('?')?.[1] || '';

  const response = NextResponse.next();

  if (url !== null) {
    response.headers.set('searchParams', sp);
  }

  return response;
}

// ëŒ€ìƒ ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
import { headers } from 'next/headers';
import { decodeState } from 'state-in-url/encodeState';

export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  const sp = headers().get('searchParams') || '';

  return (
    <div>
      <Comp1 searchParams={decodeState(sp, stateShape)} />
      {children}
    </div>
  );
}
```

#### ì„ì˜ì˜ ìƒíƒœ í˜•íƒœ ì‚¬ìš© (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)

```typescript
'use client'
import { useUrlState } from 'state-in-url/next';

const someObj = {};

function SettingsComponent() {
  const { state, updateUrl, updateState } = useUrlState<object>(someObj);
}
```

## React.jsìš© `useSharedState` í›…
React ì»´í¬ë„ŒíŠ¸ ê°„ì— ìƒíƒœë¥¼ ê³µìœ í•˜ê¸° ìœ„í•œ í›…ìœ¼ë¡œ, Next.jsì™€ Viteì—ì„œ í…ŒìŠ¤íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.

```typescript
'use client'
import { useSharedState } from 'state-in-url';

export const someState = { name: '' };

function SettingsComponent() {
  const { state, setState } = useSharedState(someState);
}
```

[ë¬¸ì„œ](packages/urlstate/useSharedState/README.md)

## React.jsìš© `useUrlEncode` í›…

[ë¬¸ì„œ](packages/urlstate/useUrlEncode/README.md)

## `encodeState` ë° `decodeState` í—¬í¼

[ë¬¸ì„œ](packages/urlstate/encodeState/README.md)

## `encode` ë° `decode` í—¬í¼

[ë¬¸ì„œ](packages/urlstate/encoder/README.md)

## ëª¨ë²” ì‚¬ë¡€

- ì¼ê´€ì„±ì„ ìœ„í•´ ìƒíƒœ í˜•íƒœë¥¼ ìƒìˆ˜ë¡œ ì •ì˜í•˜ì„¸ìš”
- í–¥ìƒëœ íƒ€ì… ì•ˆì „ì„±ê³¼ ìë™ ì™„ì„±ì„ ìœ„í•´ TypeScriptë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
- URL ë§¤ê°œë³€ìˆ˜ì— ë¯¼ê°í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ì§€ ë§ˆì„¸ìš”
- ë¹ˆë²ˆí•œ ì—…ë°ì´íŠ¸ì—ëŠ” `updateState`ë¥¼, URLì— ë³€ê²½ ì‚¬í•­ì„ ë™ê¸°í™”í•˜ë ¤ë©´ `updateUrl`ì„ ì‚¬ìš©í•˜ì„¸ìš”
- Next.jsì—ì„œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ë ¤ë©´ `Suspense`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
- ì½ê¸° ì‰¬ìš´ TS ì˜¤ë¥˜ë¥¼ ìœ„í•´ ì´ [í™•ì¥ í”„ë¡œê·¸ë¨](https://marketplace.visualstudio.com/items?itemName=yoavbls.pretty-ts-errors)ì„ ì‚¬ìš©í•˜ì„¸ìš”

## ì£¼ì˜ì‚¬í•­

1. ì§ë ¬í™” ê°€ëŠ¥í•œ ê°’ë§Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. `Function`, `BigInt` ë˜ëŠ” `Symbol`ì€ ì‘ë™í•˜ì§€ ì•Šìœ¼ë©°, `ArrayBuffer`ì™€ ê°™ì€ ê²ƒë“¤ë„ ë§ˆì°¬ê°€ì§€ì¼ ê²ƒì…ë‹ˆë‹¤.
2. Vercel ì„œë²„ëŠ” í—¤ë”(ì¿¼ë¦¬ ë¬¸ìì—´ ë° ê¸°íƒ€ í•­ëª©)ì˜ í¬ê¸°ë¥¼ **14KB**ë¡œ ì œí•œí•˜ë¯€ë¡œ URL ìƒíƒœë¥¼ ~5000 ë‹¨ì–´ ì´í•˜ë¡œ ìœ ì§€í•˜ì„¸ìš”. https://vercel.com/docs/errors/URL_TOO_LONG
3. app ë¼ìš°í„°ê°€ ìˆëŠ” `next.js` 14ì—ì„œ í…ŒìŠ¤íŠ¸ë˜ì—ˆìœ¼ë©°, pagesë¥¼ ì§€ì›í•  ê³„íšì€ ì—†ìŠµë‹ˆë‹¤.

## ë¡œì»¬ì—ì„œ ì‹¤í–‰

ì´ ì €ì¥ì†Œë¥¼ ë³µì œí•˜ê³  `npm install`ì„ ì‹¤í–‰í•œ ë‹¤ìŒ

```sh
npm run dev
```

[localhost:3000](http://localhost:3000)ìœ¼ë¡œ ì´ë™í•˜ì„¸ìš”


## ì—°ë½ ë° ì§€ì›

- ë²„ê·¸ ë¦¬í¬íŠ¸, ê¸°ëŠ¥ ìš”ì²­ ë˜ëŠ” ì§ˆë¬¸ì„ ìœ„í•´ [GitHub ì´ìŠˆ](https://github.com/asmyshlyaev177/state-in-url/issues)ë¥¼ ìƒì„±í•˜ì„¸ìš”

## [ë³€ê²½ ë¡œê·¸](https://github.com/asmyshlyaev177/state-in-url/blob/master/CHANGELOG.md)

## ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” [MIT ë¼ì´ì„ ìŠ¤](https://github.com/asmyshlyaev177/state-in-url/blob/master/LICENSE)ì— ë”°ë¼ ë¼ì´ì„ ìŠ¤ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤.

## ì˜ê°

[Vueì—ì„œ URLì„ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ ì €ì¥í•˜ê¸°](https://dev.to/jacobandrewsky/using-url-to-store-state-in-vue-275c)

[URLì— ìƒíƒœ ì €ì¥í•˜ê¸°](https://antonz.org/storing-state/)

[NextJS useSearchParams](https://nextjs.org/docs/app/api-reference/functions/use-search-params)
